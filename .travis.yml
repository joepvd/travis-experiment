language: ruby
sudo: false
dist: trusty
matrix:
    include:
        - env: trap=yes
          before_install: "set -e; f(){ sleep 1; echo slept; exit 8; }; trap 'echo caught; f' ERR; false"
        - env: trap=no
install:
    - echo set -e >>file.sh
    - echo about to execute false
    - echo false >>file.sh
    - echo executed false >>file.sh
script:
    - source file.sh
notifications:
    email: never
